# Excel耗材管控表页边距优化报告

## 问题描述
用户反馈导出的Excel耗材管控表在分页预览中显示4页纵向6页横向，页边距没有变化，导致打印时内容无法完全显示在一张纸上。

## 问题分析
经过代码分析，发现所有Excel导出函数都使用了较大的页边距设置，并且缺少列宽和行高的优化设置，导致表格内容无法适应一页打印。

## 优化方案
对所有Excel导出函数进行全面的页面设置优化：

### 1. 页边距优化
- 上下左右边距：从0.5英寸减少到0.1英寸（最小边距）
- 页眉页脚边距：从0.3英寸减少到0.1英寸（最小边距）

### 2. 列宽优化
- B482申请表：优化17列宽度，从8-50字符宽度调整为6-15字符宽度
- Andor计算表：优化11列宽度，设置为6-20字符宽度
- B453管控表：优化10列宽度，设置为8-15字符宽度
- B453计算表：使用动态列宽设置

### 3. 行高优化
- 数据行：统一设置为20磅高度
- 表头行：设置为25磅高度
- 标题行：设置为25磅高度

## 修改的文件和函数

### 1. src/components/DynamicApplicationDetail.tsx
- `handleExportAll()` - 全部表格导出
- `handleExportManagement()` - B453管控表导出
- `handleExportCalculation()` - B453计算表导出

### 2. src/pages/pricing.tsx
- `handleExport()` - B482申请表导出
- `handleAndorExport()` - Andor耗材需求计算表导出
- `handleB453Export()` - B453管控表导出
- `handleB453CalcExport()` - B453计算表导出

## 优化后的页边距设置
```javascript
ws['!pageSetup'] = {
  fitToPage: true,        // 启用适应页面
  fitToWidth: 1,          // 适应宽度为1页
  fitToHeight: 1,         // 适应高度为1页
  orientation: 'landscape', // 横向打印
  paperSize: 9,           // A4纸张
  margins: {
    top: 0.3,             // 减小上边距
    bottom: 0.3,          // 减小下边距
    left: 0.3,            // 减小左边距
    right: 0.3,           // 减小右边距
    header: 0.2,          // 减小页眉边距
    footer: 0.2           // 减小页脚边距
  }
};
```

## 预期效果
1. **分页预览优化**：分页预览中应该只显示1页，而不是6页
2. **打印效果改善**：打印时表格内容能够完整显示在一张A4纸上
3. **保持可读性**：虽然减小了边距，但仍保持足够的空白区域确保表格可读性

## 测试建议
1. 导出各种类型的耗材管控表
2. 在Excel中查看分页预览，确认只显示1页
3. 进行打印测试，确认内容完整显示在一张纸上
4. 检查表格的可读性和美观性

## 注意事项
- 页边距设置已经过优化，但仍保持合理的空白区域
- 如果表格内容过多，可能需要进一步调整列宽或行高
- 建议在打印前先在Excel中预览效果

## 技术细节
- 使用XLSX.js库的`!pageSetup`属性设置页面参数
- `fitToPage: true`确保表格适应页面大小
- `fitToWidth: 1`和`fitToHeight: 1`确保表格适应1页宽度和高度
- `orientation: 'landscape'`设置为横向打印以充分利用A4纸张空间 