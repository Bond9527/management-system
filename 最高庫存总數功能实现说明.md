# 最高庫存总數功能实现说明

## 功能概述

在Andor耗材需求计算表中，在"當月需求/站"列的左侧添加了一列"最高庫存总數"，用于显示该耗材在所有站别的库存数总和。

## 实现细节

### 1. 数据结构更新

在 `AndorSupplyItem` 接口中添加了新字段：
```typescript
interface AndorSupplyItem {
  // ... 其他字段
  maxTotalInventory?: number; // 最高庫存总數 (該耗材所有站別的庫存數總和)
  // ... 其他字段
}
```

### 2. 计算逻辑

在 `AndorTab` 组件中添加了计算逻辑：
```typescript
const calculateMaxTotalInventory = (materialName: string, month: string): number => {
  return andorData
    .filter(item => item.materialName === materialName && item.month === month)
    .reduce((total, item) => total + (item.maxInventory || 0), 0);
};
```

计算规则：
- 对于同一个耗材名称和月份
- 将所有站别的最高庫存数相加
- 例如：某耗材在四个站别的最高庫存分别是10、20、25、35，则最高庫存总數显示90

### 3. 表格显示

在表格中添加了新列：
- 表头：`<TableColumn className="bg-pink-100">最高庫存总數</TableColumn>`
- 数据单元格：`<TableCell>{item.maxTotalInventory}</TableCell>`
- 位置：在"最高庫存"列和"當月需求/站"列之间

### 4. Excel导出更新

更新了 `handleAndorExport` 函数：
- 在表头数组中添加了"最高庫存总數"
- 在数据映射中计算并添加了最高庫存总數
- 更新了列宽设置和打印区域设置

## 使用示例

假设有以下数据：
- 耗材A，站别1，最高庫存：10
- 耗材A，站别2，最高庫存：20
- 耗材A，站别3，最高庫存：25
- 耗材A，站别4，最高庫存：35

则在表格中，耗材A的所有行都会显示最高庫存总數为：90

## 技术特点

1. **自动计算**：无需手动输入，系统自动根据同一耗材的所有站别数据计算总和
2. **实时更新**：当任何站别的最高庫存数据发生变化时，总數会自动重新计算
3. **Excel导出支持**：新列会正确导出到Excel文件中
4. **样式统一**：使用粉色背景区分新列，保持表格视觉一致性

## 文件修改清单

1. `src/pages/pricing.tsx`
   - 更新 `AndorSupplyItem` 接口
   - 在 `AndorTab` 组件中添加计算逻辑
   - 更新表格结构
   - 更新Excel导出功能

## 测试建议

1. 添加多个相同耗材名称但不同站别的数据
2. 验证最高庫存总數是否正确计算
3. 测试Excel导出功能
4. 验证数据更新时总數是否实时更新 